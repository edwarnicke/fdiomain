<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="">
<meta name="viewport" content="width=device-width, initial-scale=1">









<title>Quick Start</title>

<meta name="generator" content="Hugo 0.49" />

<meta name="hugo.type" content="setup">

















<link rel="stylesheet"
      href="/fdiomain/bundle.min.8bf4c191efae4f27c4bc627263b1c8e140e8344383f894b4a143ce7774009f9b.css"
      integrity="sha256-i/TBke&#43;uTyfEvGJyY7HI4UDoNEOD&#43;JS0oUPOd3QAn5s=">












<script defer src="/fdiomain/bundle.min.3e87135058cd0f4e4db4987f5162be5af4aec75afd881b94a2f454f4bede4367.js"
        integrity="sha256-PocTUFjND05NtJh/UWK&#43;WvSux1r9iBuUovRU9L7eQ2c="></script>


</head>
<body>

    
<header>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="col-md-1">
        <a class="navbar-brand" href="/">
            <img class="img-responsive" src="/img/logo_fdio_header.png" alt="FDio - The Universal Dataplane Logo">
        </a>
    </div>
    <div class="col-md-10 fix-navbar-zindex">
      
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
          </div>
            
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav navbar-right">
              
                <li><a href="https://gerrit.fd.io/">GERRIT</a></li>
              
                <li><a href="/fdiomain/docs/">DOCUMENTATION</a></li>
              
                <li><a href="/fdiomain/community/">COMMUNITY</a></li>
              
                <li><a href="/fdiomain/events/">EVENTS</a></li>
              
                <li><div id="qrcode"></div></li>
              </ul>
            </div>
          </div>
        </nav>
      </div>
    </div>
  </div>
</header>
<div id="qrbig"></div>

    
<section id="docs-header">
    <div class="container">
        <div class="row">
            <div class="col-md-2"></div>
            <div class="col-md-2"><a href="/docs/concepts/">CONCEPTS</a></div>
            <div class="col-md-2"><a href="/docs/setup/">SETUP</a></div>
            <div class="col-md-2"><a href="/docs/tasks/">TASKS</a></div>
            <div class="col-md-2"><a href="/docs/videos/">VIDEOS</a></div>
            <div class="col-md-2"></div>
        </div>
    </div>
</section>
    
    <section>
        <div class="container">
            <div class="row">
            <div class="col-md-12">
                
                <img src="http://jadenisco.github.io/img/setup/quickstart.jpg" class="img-responsive" alt="post-thumb"> 
                <div class="block markdown-body">
                <h1 id="quick-start-network-service-mesh">Quick Start Network Service Mesh</h1>

<p>This document will help you configure two Vagrant boxes in a Kubernetes cluster with a master and a worker node. You will also deploy the Network Service Mesh components in the cluster.</p>

<h2 id="pre-requisites">Pre-requisites</h2>

<p>You can find instructions for your operation systems in the links below:</p>

<ul>
<li><a href="/docs/setup/centos">CentOS</a></li>
<li><a href="/docs/setup/osx">OSX</a></li>
<li><a href="/docs/setup/ubuntu">Ubuntu</a></li>
</ul>

<p>If you have another Linux distribution or prefer to go with the upstream, here</p>

<ul>
<li><a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a></li>
<li><a href="https://www.vagrantup.com/docs/installation/">Vagrant</a></li>
<li><a href="https://docs.docker.com/install/">Docker</a></li>
<li><a href="https://kubernetes.io/docs/tasks/tools/install-kubectl/">kubectl</a></li>
</ul>

<h3 id="getting-the-network-service-mesh-project">Getting the Network Service Mesh project</h3>

<pre><code class="language-bash">git clone https://github.com/networkservicemesh/networkservicemesh &amp;&amp; cd networkservicemesh
cd networkservicemesh
</code></pre>

<h3 id="build">Build</h3>

<p>First let&rsquo;s build the Docker images of the various components</p>

<pre><code class="language-bash">make k8s-save
</code></pre>

<h3 id="local-vagrant-setuo">Local Vagrant setuo</h3>

<p>Then we&rsquo;ll configure a Kubernetes cluster. A master and a worker node will be launched in two separate Vagrant machines. The Network Service Mesh components will then be deployed to the cluster.</p>

<pre><code class="language-bash">make vagrant-start
</code></pre>

<p>Ensure your <code>kubectl</code> is configured to point to Vagrant&rsquo;s Kubernetes cluster.</p>

<pre><code class="language-bash">source scripts/vagrant/env.sh
</code></pre>

<h3 id="deploy-the-core-network-service-mesh-components">Deploy the core Network Service Mesh components</h3>

<p>The core Network Service Mesh infrastructure is deployed with the following command.</p>

<pre><code class="language-bash">make k8s-infra-deploy
</code></pre>

<h3 id="verify-the-services-are-up-and-running">Verify the services are up and running</h3>

<p>A simple check should show two <code>nsmd</code>, two <code>nsm-vppagent-dataplane</code>, two <code>skydive-agent</code>, one <code>crossconnect-monitor</code> and one <code>skydive-analyzer</code> pods.</p>

<pre><code class="language-bash">kubect get pods
</code></pre>

<p>This will allow you to see your Network Service Mesh daemonset running:</p>

<pre><code class="language-bash">kubectl get daemonset nsmd


NAME   DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR   AGE
nsmd   2         2         2       2            2           &lt;none&gt;          19m
</code></pre>

<h3 id="running-the-networking-service-mesh-examples">Running the Networking Service Mesh examples</h3>

<p>The basic ICMP example is deployed like this:</p>

<pre><code class="language-bash">make k8s-icmp-deploy
</code></pre>

<p>The VPN service composition example is deployed with:</p>

<pre><code class="language-bash">make k8s-vpn-deploy
</code></pre>

<h3 id="test">Test</h3>

<p>Both of the examples can be verified by running a simple check:</p>

<pre><code class="language-bash">make k8s-check
</code></pre>

<p>For ICMP you should see ping succeeding as below:</p>

<pre><code class="language-bash">./scripts/nsc_ping_all.sh
===== &gt;&gt;&gt;&gt;&gt; PROCESSING nsc-84799b768f-99wgf  &lt;&lt;&lt;&lt;&lt; ===========
PING 10.20.1.2 (10.20.1.2): 56 data bytes
64 bytes from 10.20.1.2: seq=0 ttl=64 time=6.313 ms

--- 10.20.1.2 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.313/6.313/6.313 ms
NSC nsc-84799b768f-99wgf with IP 10.20.1.1/30 pinging icmp-responder-nse TargetIP: 10.20.1.2 successful
===== &gt;&gt;&gt;&gt;&gt; PROCESSING nsc-84799b768f-d82w5  &lt;&lt;&lt;&lt;&lt; ===========
PING 10.20.1.2 (10.20.1.2): 56 data bytes
64 bytes from 10.20.1.2: seq=0 ttl=64 time=1.015 ms

--- 10.20.1.2 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.015/1.015/1.015 ms
NSC nsc-84799b768f-d82w5 with IP 10.20.1.1/30 pinging icmp-responder-nse TargetIP: 10.20.1.2 successful
===== &gt;&gt;&gt;&gt;&gt; PROCESSING nsc-84799b768f-ktm4w  &lt;&lt;&lt;&lt;&lt; ===========
PING 10.30.1.2 (10.30.1.2): 56 data bytes
64 bytes from 10.30.1.2: seq=0 ttl=64 time=3.199 ms

--- 10.30.1.2 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.199/3.199/3.199 ms
NSC nsc-84799b768f-ktm4w with IP 10.30.1.1/30 pinging vppagent-icmp-responder-nse TargetIP: 10.30.1.2 successful
===== &gt;&gt;&gt;&gt;&gt; PROCESSING nsc-84799b768f-wvxwt  &lt;&lt;&lt;&lt;&lt; ===========
PING 10.30.1.2 (10.30.1.2): 56 data bytes
64 bytes from 10.30.1.2: seq=0 ttl=64 time=6.070 ms

--- 10.30.1.2 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.070/6.070/6.070 ms
NSC nsc-84799b768f-wvxwt with IP 10.30.1.1/30 pinging vppagent-icmp-responder-nse TargetIP: 10.30.1.2 successful
</code></pre>

<p>Validating the VPN example will output the following:</p>

<pre><code class="language-bash">===== &gt;&gt;&gt;&gt;&gt; PROCESSING vpn-gateway-nsc-5458d48c86-zh4xf  &lt;&lt;&lt;&lt;&lt; ===========
PING 10.60.1.2 (10.60.1.2): 56 data bytes
64 bytes from 10.60.1.2: seq=0 ttl=64 time=11.728 ms

--- 10.60.1.2 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 11.728/11.728/11.728 ms
NSC vpn-gateway-nsc-5458d48c86-zh4xf with IP 10.60.1.1/30 pinging vpn-gateway-nse TargetIP: 10.60.1.2 successful
Connecting to 10.60.1.2:80 (10.60.1.2:80)
null                 100% |*******************************|   112   0:00:00 ETA
NSC vpn-gateway-nsc-5458d48c86-zh4xf with IP 10.60.1.1/30 accessing vpn-gateway-nse TargetIP: 10.60.1.2 TargetPort:80 successful
Connecting to 10.60.1.2:8080 (10.60.1.2:8080)
wget: download timed out
command terminated with exit code 1
NSC vpn-gateway-nsc-5458d48c86-zh4xf with IP 10.60.1.1/30 blocked vpn-gateway-nse TargetIP: 10.60.1.2 TargetPort:8080
All check OK. NSC vpn-gateway-nsc-5458d48c86-zh4xf behaving as expected.
</code></pre>

                </div>
            </div>
            </div>
        </div>
    </section>

	
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="footer-manu">
          <ul>
            
          </ul>
        </div>
        <p><a href="https://themes.gohugo.io/airspace-hugo/">Airspace Hugo Theme</a> Copyright &copy; Design &amp; Developed by <a href="https://themefisher.com/">Themefisher</a>. <a href="https://themefisher.com/license/">Creative Commons Attribution 3.0 License.</a></p>
      </div>
    </div>
  </div>
</footer>


	
</body>
</html>
